<ion-header>
  <ion-toolbar>
    <form action=".">
      <ion-searchbar placeholder="Search Common or Scientific Name..." value="{{searchQuery}}" (change)="checkAPI($event, false)" type="search" (ionClear)="clearSearch()" [(ngModel)]="singleLetterQuery" [ngModelOptions]="{standalone: true}" showSearchButton animated></ion-searchbar>
    </form>
  </ion-toolbar>

  <ion-toolbar class="saltSwitch" *ngIf="!speciesSelected && !searchQuery">
    <ion-item class="toggle">
      <h1 class="pondTitleVersion">Pond v0.5.4</h1>
      <ion-label>Saltwater Mode</ion-label>
      <ion-toggle [(ngModel)]="saltwater"></ion-toggle>
    </ion-item>
  </ion-toolbar>

  <ion-toolbar class="alphabetHeader" *ngIf="!speciesSelected && searchQuery">
    <ion-item>
      <ul class="alphabet">
        <li class="letter" (click)="selectLetter('a')" [ngClass]="{'litLetter' : selectedLetter == 'a'}">a</li>
        <li class="letter" (click)="selectLetter('b')" [ngClass]="{'litLetter' : selectedLetter == 'b'}">b</li>
        <li class="letter" (click)="selectLetter('c')" [ngClass]="{'litLetter' : selectedLetter == 'c'}">c</li>
        <li class="letter" (click)="selectLetter('d')" [ngClass]="{'litLetter' : selectedLetter == 'd'}">d</li>
        <li class="letter" (click)="selectLetter('e')" [ngClass]="{'litLetter' : selectedLetter == 'e'}">e</li>
        <li class="letter" (click)="selectLetter('f')" [ngClass]="{'litLetter' : selectedLetter == 'f'}">f</li>
        <li class="letter" (click)="selectLetter('g')" [ngClass]="{'litLetter' : selectedLetter == 'g'}">g</li>
        <li class="letter" (click)="selectLetter('h')" [ngClass]="{'litLetter' : selectedLetter == 'h'}">h</li>
        <li class="letter" (click)="selectLetter('i')" [ngClass]="{'litLetter' : selectedLetter == 'i'}">i</li>
        <li class="letter" (click)="selectLetter('j')" [ngClass]="{'litLetter' : selectedLetter == 'j'}">j</li>
        <li class="letter" (click)="selectLetter('k')" [ngClass]="{'litLetter' : selectedLetter == 'k'}">k</li>
        <li class="letter" (click)="selectLetter('l')" [ngClass]="{'litLetter' : selectedLetter == 'l'}">l</li>
        <li class="letter" (click)="selectLetter('m')" [ngClass]="{'litLetter' : selectedLetter == 'm'}">m</li>
        <li class="letter" (click)="selectLetter('n')" [ngClass]="{'litLetter' : selectedLetter == 'n'}">n</li>
        <li class="letter" (click)="selectLetter('o')" [ngClass]="{'litLetter' : selectedLetter == 'o'}">o</li>
        <li class="letter" (click)="selectLetter('p')" [ngClass]="{'litLetter' : selectedLetter == 'p'}">p</li>
        <li class="letter" (click)="selectLetter('q')" [ngClass]="{'litLetter' : selectedLetter == 'q'}">q</li>
        <li class="letter" (click)="selectLetter('r')" [ngClass]="{'litLetter' : selectedLetter == 'r'}">r</li>
        <li class="letter" (click)="selectLetter('s')" [ngClass]="{'litLetter' : selectedLetter == 's'}">s</li>
        <li class="letter" (click)="selectLetter('t')" [ngClass]="{'litLetter' : selectedLetter == 't'}">t</li>
        <li class="letter" (click)="selectLetter('u')" [ngClass]="{'litLetter' : selectedLetter == 'u'}">u</li>
        <li class="letter" (click)="selectLetter('v')" [ngClass]="{'litLetter' : selectedLetter == 'v'}">v</li>
        <li class="letter" (click)="selectLetter('w')" [ngClass]="{'litLetter' : selectedLetter == 'w'}">w</li>
        <li class="letter" (click)="selectLetter('x')" [ngClass]="{'litLetter' : selectedLetter == 'x'}">x</li>
        <li class="letter" (click)="selectLetter('y')" [ngClass]="{'litLetter' : selectedLetter == 'y'}">y</li>
        <li class="letter" (click)="selectLetter('z')" [ngClass]="{'litLetter' : selectedLetter == 'z'}">z</li>
      </ul>
    </ion-item>
  </ion-toolbar>

</ion-header>

<div class="selectTankPopup" *ngIf="showSelectTank">
  <div class="loadingSpinner lessTopSpinner" *ngIf="showTankListLoader">
    <ion-spinner name="crescent"></ion-spinner>
  </div>

  <ion-icon class="checkIcon" name="checkmark" *ngIf="showTankListTick"></ion-icon>

  <div *ngIf="!showTankListLoader && !showTankListTick && !showTankQuanityList">
    <h1>Add {{toAddToTankSpecies.name}} to Tank?</h1>

    <ion-list>
      <ion-item *ngFor="let tank of tanks">
        <ion-label (click)="addFishToTank(tank)">{{tank.name}}</ion-label>
      </ion-item>
    </ion-list>
  </div>

  <div *ngIf="!showTankListLoader && !showTankListTick && showTankQuanityList">
    <h1>Select quantity of {{toAddToTankSpecies.name}}'s</h1>

    <ion-input class="centerSelectNumber" type="number" value="1" (change)="setSpeciesTankQuantity($event.target.value)"></ion-input>
  </div>

</div>

<div class="backgroundDimmer" (click)="hideTankMenu()" *ngIf="showSelectTank"></div>

<ion-content *ngIf="!speciesSelected" class="blueBack" id="coreScroll">

  <div *ngIf="selectedLetter">
    <div class="topTitle centerTit">{{letterCounter.length}} results for {{selectedLetter}} in {{searchQuery}} <a (click)="clearLetter()">clear</a></div>

    <div *ngIf="letterCounter.length >= 1" class="theResults">
      <div *ngFor="let fish of letterCounter">
        <div class="speciesBrick animated bounceInLeft">

          <ion-slides pager="true" *ngIf="fish.Pic" (click)="selectSpecies(fish, false)">
           <ion-slide class="imageBox">
             <img [src]="fish.Pic[0]" *ngIf="fish.Pic[0]" />
             <img src="../assets/noImg.png" *ngIf="!fish.Pic[0]" />
           </ion-slide>
           <ion-slide class="imageBox">
             <img [src]="fish.Pic[1]" *ngIf="fish.Pic[1]" />
             <img src="../assets/noImg.png" *ngIf="!fish.Pic[1]" />
           </ion-slide>
           <ion-slide class="imageBox">
             <img [src]="fish.Pic[2]"  *ngIf="fish.Pic[2]" />
             <img src="../assets/noImg.png" *ngIf="!fish.Pic[2]" />
           </ion-slide>
           <ion-slide class="imageBox">
             <img [src]="fish.Pic[3]" *ngIf="fish.Pic[3]" />
             <img src="../assets/noImg.png" *ngIf="!fish.Pic[3]" />
           </ion-slide>
           <ion-slide class="imageBox" *ngIf="fish.PicPreferredName">
             <img src="https://www.fishbase.de/images/species/{{fish.PicPreferredName}}" />
           </ion-slide>
          </ion-slides>

          <h2 *ngIf="fish.FBname" (click)="selectSpecies(fish, false)">{{fish.FBname}}</h2>
          <h2 *ngIf="!fish.FBname" (click)="selectSpecies(fish, false)">The {{fish.Species}}</h2>
          <h3>
            <b (click)="showGenus(fish.Genus)"> {{fish.Genus}}</b>
            <i> {{fish.Species}}</i> <br />
            <label *ngIf="fish.CommonLength">Length - {{fish.CommonLength}}cm &bull;</label>
            Max Length - {{fish.Length}}cm
          </h3>

        </div>
      </div>
    </div>

    <label class="nothingFoundTxt" *ngIf="letterCounter.length < 1"><b>No results returned :(</b></label>

  </div>

  <div *ngIf="!speciesSelected && !selectedLetter">

    <div *ngIf="searchQuery.length <= 2">
      <img *ngIf="!saltwater" src="../assets/whiteKoiClear.png" class="koiLogo animated pulse infinite"/>
      <img *ngIf="saltwater" src="../assets/turtleClear.png" class="koiLogo tunaLogo animated pulse infinite"/>
    </div>

    <div  class="loadingSpinner" *ngIf="searchQuery.length > 2 && !doneLoading">
      <ion-spinner name="crescent"></ion-spinner>
    </div>

    <label class="nothingFoundTxt" *ngIf="searchQuery.length > 2 && doneLoading && this.ourFish.length == 0 && this.fbSpecies.length == 0 && this.relatedSpecies.length == 0"><b>No results returned.</b> <br  /><br /> Please try a different query. If nothing seems to work, type the fish name into google, then copy either the genus or species name into the searchbar.</label>

    <div *ngIf="doneLoading && ourFish.length >= 1" class="theResults">
      <div class="topTitle">{{ourFish.length}} Species Found from Pond</div>

      <ion-card class="animated bounceInLeft" *ngFor="let fish of ourFish">
        <ion-card-header>
          <ion-card-subtitle>{{fish.genus}} <i>{{fish.species}}</i></ion-card-subtitle>
          <ion-card-title (click)="selectSpecies(fish, false)">{{fish.name}}</ion-card-title>
        </ion-card-header>

        <ion-slides pager="false" *ngIf="fish.Pic" (click)="selectSpecies(fish, true)">
         <ion-slide class="imageBox">
           <img *ngIf="fish.Pic[0]" [src]="fish.Pic[0]" default="../assets/noImg.png"/>
         </ion-slide>
         <ion-slide class="imageBox">
           <img *ngIf="fish.Pic[1]" [src]="fish.Pic[1]" default="../assets/noImg.png"/>
         </ion-slide>
         <ion-slide class="imageBox">
           <img *ngIf="fish.Pic[2]" [src]="fish.Pic[2]" default="../assets/noImg.png"/>
         </ion-slide>
         <ion-slide class="imageBox">
           <img *ngIf="fish.Pic[3]" [src]="fish.Pic[3]" default="../assets/noImg.png"/>
         </ion-slide>
         <ion-slide class="imageBox">
           <img *ngIf="fish.Pic[4]" [src]="fish.Pic[4]" default="../assets/noImg.png"/>
         </ion-slide>
         <ion-slide class="imageBox">
           <img *ngIf="fish.Pic[5]" [src]="fish.Pic[5]" default="../assets/noImg.png"/>
         </ion-slide>
         <ion-slide class="imageBox">
           <img *ngIf="fish.Pic[6]" [src]="fish.Pic[6]" default="../assets/noImg.png"/>
         </ion-slide>
         <ion-slide class="imageBox">
           <img *ngIf="fish.Pic[7]" [src]="fish.Pic[7]" default="../assets/noImg.png"/>
         </ion-slide>
         <ion-slide class="imageBox">
           <img *ngIf="fish.Pic[8]" [src]="fish.Pic[8]" default="../assets/noImg.png"/>
         </ion-slide>
         <ion-slide class="imageBox">
           <img *ngIf="fish.Pic[9]" [src]="fish.Pic[9]" default="../assets/noImg.png"/>
         </ion-slide>
        </ion-slides>

        <!-- <ion-card-content>
          <label *ngIf="fish.length">{{fish.habitat}}</label>
        </ion-card-content> -->
      </ion-card>
    </div>

    <!-- FISHBASE SPECIES -->
    <div *ngIf="doneLoading && fbSpecies.length >= 1" class="theResults">

      <div class="topTitle"><label *ngIf="fbSpecies.length >= 10">{{maxSpeciesReturn}}/</label>{{fbSpecies.length}} Species Found from Fishbase</div>

      <div *ngFor="let fish of fbSpecies">

        <ion-card class="animated bounceInLeft" *ngIf="fish.id >= minSpeciesReturn && fish.id <= maxSpeciesReturn">
          <ion-card-header>
            <ion-card-subtitle><b (click)="showGenus(fish.Genus)">{{fish.Genus}}</b><i> {{fish.Species}}</i></ion-card-subtitle>
            <ion-card-title *ngIf="fish.FBname">{{fish.FBname}}</ion-card-title>
            <ion-card-title *ngIf="!fish.FBname">{{fish.Species}}</ion-card-title>
          </ion-card-header>

          <ion-slides pager="false" *ngIf="fish.Pic" (click)="selectSpecies(fish, false)">
           <ion-slide class="imageBox">
             <img *ngIf="fish.Pic[0]" [src]="fish.Pic[0]" default="../assets/noImg.png"/>
           </ion-slide>
           <ion-slide class="imageBox">
             <img *ngIf="fish.Pic[1]" [src]="fish.Pic[1]" default="../assets/noImg.png"/>
           </ion-slide>
           <ion-slide class="imageBox">
             <img *ngIf="fish.Pic[2]" [src]="fish.Pic[2]" default="../assets/noImg.png"/>
           </ion-slide>
           <ion-slide class="imageBox">
             <img *ngIf="fish.Pic[3]" [src]="fish.Pic[3]" default="../assets/noImg.png"/>
           </ion-slide>
          </ion-slides>

          <!-- <ion-card-content>
            <label *ngIf="fish.CommonLength">Length - {{fish.CommonLength}}cm &bull;</label>
            Max Length - {{fish.Length}}cm
          </ion-card-content> -->
        </ion-card>
      </div>
      <label class="nextPageTxt" (click)="nextPage()" *ngIf="fbSpecies.length >= 10"> -- NEXT PAGE --</label>
      <label class="nextPageTxt prev" (click)="previousPage()" *ngIf="minSpeciesReturn >= 10"> -- PREVIOUS PAGE --</label>
    </div>

    <!-- FISHBASE RELATED SPECIES -->

    <div *ngIf="doneLoading && relatedSpecies.length >= 1" class="theResults">
      <div class="topTitle">{{relatedSpecies.length}} Species Related</div>

      <ion-card class="animated bounceInLeft" *ngFor="let fish of relatedSpecies">
        <ion-card-header>
          <ion-card-subtitle><b (click)="showGenus(fish.Genus)">{{fish.Genus}}</b><i> {{fish.Species}}</i></ion-card-subtitle>
          <ion-card-title *ngIf="fish.FBname">{{fish.FBname}}</ion-card-title>
          <ion-card-title *ngIf="!fish.FBname" (click)="selectSpecies(fish, false)" >The {{fish.Species}}</ion-card-title>
        </ion-card-header>

        <ion-slides pager="false" *ngIf="fish.Pic" (click)="selectSpecies(fish, false)">
         <ion-slide class="imageBox">
           <img src="../assets/noImg.png" [src]="fish.Pic[0]" *ngIf="fish.Pic[0]" />
           <img src="../assets/noImg.png" *ngIf="!fish.Pic[0]" />
         </ion-slide>
         <ion-slide class="imageBox">
           <img src="../assets/noImg.png" [src]="fish.Pic[1]" *ngIf="fish.Pic[1]" />
           <img src="../assets/noImg.png" *ngIf="!fish.Pic[1]" />
         </ion-slide>
         <ion-slide class="imageBox">
           <img src="../assets/noImg.png" [src]="fish.Pic[2]"  *ngIf="fish.Pic[2]" />
           <img src="../assets/noImg.png" *ngIf="!fish.Pic[2]" />
         </ion-slide>
         <ion-slide class="imageBox">
           <img src="../assets/noImg.png" [src]="fish.Pic[3]" *ngIf="fish.Pic[3]" />
           <img src="../assets/noImg.png" *ngIf="!fish.Pic[3]" />
         </ion-slide>
         <ion-slide class="imageBox" *ngIf="fish.PicPreferredName">
           <img src="https://www.fishbase.de/images/species/{{fish.PicPreferredName}}" />
         </ion-slide>
        </ion-slides>

        <!-- <ion-card-content>
          <label *ngIf="fish.CommonLength">Length - {{fish.CommonLength}}cm &bull;</label>
          Max Length - {{fish.Length}}cm
        </ion-card-content> -->
      </ion-card>

      <label class="nextPageTxt" (click)="nextPage()" *ngIf="relatedSpecies.length >= 10"> -- NEXT PAGE --</label>
      <label class="nextPageTxt prev" (click)="previousPage()" *ngIf="minSpeciesReturn >= 10"> -- PREVIOUS PAGE --</label>
    </div>
  </div>

</ion-content>

<ion-content *ngIf="speciesSelected">
  <div  class="speciesSelectedMode">
    <ion-icon name="arrow-back" (click)="unSelectSpecies()" class="backArrow"></ion-icon>

    <div class="loadingSpinner detailSpinner" *ngIf="!speciesLoaded || !species.species">
      <ion-spinner name="crescent"></ion-spinner>
    </div>

    <ion-card *ngIf="speciesLoaded && species.genus">
      <ion-card-content>
        <ion-slides pager="false">
         <ion-slide class="imageBox" *ngFor="let img of speciesImgArray; let i = index">
           <img *ngIf="img" [src]="img" />
          </ion-slide>
        </ion-slides>
      </ion-card-content>
      <!-- WIKIPEDIA DESCRIPTION -->
      <p [ngClass]="{'wikiDescriptionSmall' : !fullWikiText}" class="wikiDescription" *ngIf="species.wikiDesc"> {{species.wikiDesc}} </p>
      <a class="centerSeeMore" *ngIf="!fullWikiText && species.wikiDesc" (click)="seeFulText()">See More <ion-icon name="arrow-dropdown"></ion-icon></a>
      <a class="centerSeeMore" *ngIf="fullWikiText && species.wikiDesc" (click)="seeLessText()">See Less <ion-icon name="arrow-dropup"></ion-icon></a>

    </ion-card>

    <ion-card class="coreInformation" *ngIf="speciesLoaded && species.genus">
      <ion-card-header>
        <ion-card-subtitle>
          <a (click)="showGenus(species.genus)">{{species.genus}}</a> <label class="speciesName"> {{species.species}}</label>
          <br /><br /> <a (click)="addTankTrigger(species)" class="addSpeciesClicker">+ Add Species to tank</a>
        </ion-card-subtitle>
        <ion-card-title>{{species.name}}</ion-card-title>
      </ion-card-header>

      <ion-card-content>
        <ul>

          <!-- PLANET CATFISH INFO -->
          <li *ngIf="species.etymology"><i>{{species.etymology}}</i></li>
          <br *ngIf="species.etymology" />

          <!-- WIKIPEDIA COMMON NAME -->
          <label *ngIf="species.wikiName">
            <li *ngIf="!species.name || species.wikiName.toLowerCase() !== species.name"><b>Other Name :</b><br />  {{species.wikiName}}</li>
            <br *ngIf="!species.name || species.wikiName.toLowerCase() !== species.name" />
          </label>

          <!-- PULLED FROM BEST SOURCE -->
          <li *ngIf="species.temperature"><b>Recommended Temperature :</b><br />  {{species.temperature}}</li>
          <br *ngIf="species.temperature" />
          <li *ngIf="species.ph"><b>Recommended PH :</b><br /> {{species.ph}}</li>
          <br *ngIf="species.ph" />
          <li *ngIf="species.hardness"><b>Recommended Hardness :</b><br /> {{species.hardness}}</li>


          <br *ngIf="species.hardness" />

          <li *ngIf="species.locality"><b>Locality :</b><br /> {{species.locality}}</li>

          <br *ngIf="species.locality" />

          <!-- PULLED FROM SERIOUSLY FISH -->
          <li *ngIf="species.habitat"><b>Habitat :</b><br /> {{species.habitat}}</li>
          <br *ngIf="species.habitat" />
          <li *ngIf="species.blackWater"><b>Black Water? :</b><br /> {{species.blackWater}}</li>
          <br *ngIf="species.blackWater" />
          <li *ngIf="species.aquaticPlants"><b>Aquatic Plants Recommended? :</b><br /> {{species.aquaticPlants}}</li>
          <br *ngIf="species.aquaticPlants" />
          <li *ngIf="species.recommendedTankSize"><b>Recommended Tank Size :</b><br /> {{species.recommendedTankSize}}</li>
          <br *ngIf="species.recommendedTankSize" />
          <li *ngIf="species.sexIdentificationFeatures"><b>Sexing Identification Features :</b><br /> {{species.sexIdentificationFeatures}}</li>

          <br *ngIf="species.sexIdentificationFeatures" />

          <!-- PLANET CATFISH INFO -->
          <li *ngIf="species.size"><b>Size :</b><br /> {{species.size}}</li>
          <br *ngIf="species.size" />
          <li *ngIf="species.identification"><b>Identification :</b><br /> {{species.identification}}</li>
          <br *ngIf="species.identification" />
          <li *ngIf="species.sexing"><b>Sexing :</b><br /> {{species.sexing}}</li>
          <br *ngIf="species.sexing" />
          <li *ngIf="species.distribution"><b>Distribution :</b><br /> {{species.distribution}}</li>
          <br *ngIf="species.distribution" />
          <li *ngIf="species.feeding"><b>Feeding :</b><br /> {{species.feeding}}</li>
          <br *ngIf="species.feeding" />
          <li *ngIf="species.furniture"><b>Recommended Tank Decoration :</b><br /> {{species.furniture}}</li>
          <br *ngIf="species.furniture" />
          <li *ngIf="species.compatibility"><b>Compatibility :</b><br /> {{species.compatibility}}</li>
          <br *ngIf="species.compatibility" />
          <li *ngIf="species.tankMates"><b>Recommended Tank Mates :</b><br /> {{species.tankMates}}</li>

          <br *ngIf="species.tankMates" />

          <!-- FISHBASE INFO -->
          <li *ngIf="species.speciesVunFloored"><b>Vunerability Status :</b><br /> {{speciesVunFloored}}/100</li>
          <br *ngIf="species.speciesVunFloored"/>
          <li *ngIf="species.dangerous !== 'harmless'"><b>Danger to human status :</b><br /> {{species.dangerous}}</li>

          <br *ngIf="species.dangerous != 'harmless'" /><br *ngIf="species.dangerous && species.dangerous !== 'harmless'" />

          <li *ngIf="species.comments"><b>Other Comments :</b><br /> {{species.comments}}</li>

        </ul>

      </ion-card-content>
    </ion-card>


      <!-- <div *ngIf="species">
        <div class="informationBrick" *ngIf="speciesDataLoaded">
          <h1>{{species.species}}</h1>
          <h2 *ngIf="species.name">"{{species.name}}"</h2>
          <h3>{{species.genus}}</h3>

        </div>

        <div class="informationBrick">
            <button class="addToTankButton">Add species to Tank</button>
        </div>

        <div class="informationBrick variationsBrick">
            <h4>Variations</h4>
            <h5 (click)="addVariation(species)">Add a variation</h5>
            <label class="noVariations" *ngIf="variations.length == 0">No variations where found for {{species.species}}</label>
            <div class="speciesGrid" *ngFor="let variation of variations">
              <div class="speciesBlock">{{variation.name}}</div>
            </div>
        </div>

      </div> -->
  </div>
</ion-content>
